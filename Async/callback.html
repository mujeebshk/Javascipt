<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async-JS</title>
    <script src="FetchApi.js"></script>
</head>
<body>
    <h1>Asynchronous Javascript()</h1>
    <script>
        // const get = (callback) => {
        //     const request = new XMLHttpRequest();

        //     request.addEventListener('readystatechange', () => {
        //         if (request.readyState === 4 && request.status === 200){
        //             const data = JSON.parse(request.responseText)
        //             callback (undefined, data);
        //         } else if(request.readyState === 3){
        //             callback('could not fetch data', undefined); // -> 6
        //         }
        //     });


        // Promise method

        const get = (resource)  => {
            return new Promise ((resolve, reject) => {
                const request = new XMLHttpRequest();

                request.addEventListener('readystatechange', () => {
                    if (request.readyState === 4 && request.status === 200) {
                        const data = JSON.parse(request.responseText);
                        resolve(data);
                    } else if (request.readyState === 4) {
                        reject('error getting resource')
                    }
                });
            
              // request.open('GET', 'https://jsonplaceholder.typicode.com/todos/'); // Fake - API server
              request.open('GET', resource) // Created json file and added in...
              request.send()
            })
        }
         // Promise Chaining..
        get('Get.json').then(data => {
            console.log('Promise resolved :', data);
            return get('Get2.json').then(data => {
                console.log ('Promise 2 resolved :', data);
                return get('Get3.json').then(data => {
                    console.log ('Promise 3 resolved :', data)
                })
            })
        }).catch(err => {
            console.log('Promise rejected : ', err)
        })
        // console.log('Asynchronous') // for example It runs -> 1
        // console.log('code run start now') // ex -> 2
        // get ((err, data) => {
        //     console.log('callback fired'); // -> 5, 7
        //     if (err){
        //         console.log(err);
        //     } else {
        //         console.log(data) // -> 8
        //     }
        // })

        // console.log('And finish later') // ex -> 3
        // console.log('Here we can see that ') // ex -> 4
    </script>
</body>
</html>